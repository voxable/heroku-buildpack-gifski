#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

set -e

BUILD_DIR=$1
CACHE_DIR=$2
ENV_DIR=$3
TMP_PATH="$BUILD_DIR/tmp"

mkdir -p $CACHE_DIR $BIN_PATH $TMP_PATH

if [[ -f "$ENV_DIR/GIFSKI_VERSION" ]]; then
  GIFSKI_VERSION=$(cat "$ENV_DIR/GIFSKI_VERSION")
else
  GIFSKI_VERSION="1.7.1"
fi

echo "-----> Installing gifski via cargo"
cargo install gifski@$GIFSKI_VERSION